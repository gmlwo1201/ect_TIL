# **AWS TIL**

## AWS 핵심 서비스
* 컴퓨팅 서비스
  - EC2 (Elastic Compute Cloud): 가상 서버, 온디맨드/스팟 인스턴스
  - Lambda: 서버리스 컴퓨팅, 이벤트 기반 실행
* 스토리지 서비스
  - S3 (Simple Storage Service): 객체 스토리지, 정적 웹 호스팅
  - EBS (Elastic Block Store): EC2 인스턴스를 위한 블록 스토리지
* 네트워크 및 콘텐츠 전송
  - VPC (Virtual Private Cloud): AWS 내 네트워크 구성
  - Route 53: 도메인 네임 서비스(DNS)
  - CloudFront: CDN(콘텐츠 전송 네트워크)
* 데이터베이스 서비스
  - RDS (Relational Database Service): 관리형 데이터베이스(MySQL, PostgreSQL, MariaDB 등)
  - DynamoDB: NoSQL, 키-값 저장소
* 보안 및 접근관리
  - IAM (Identity and Access Management): 사용자 및 권한 관리
  - Security Group (보안 그룹): 인바운드 및 아웃바운드 트래픽 제어

## AWS 구조
* 리전
  - 가장 큰 단위, 리전 안에 다양한 가용영역 존재
  - AWS의 서비스가 제공되는 서버의 물리적 위치
  - 전 세계에 흩어져 있음, 큰 부분 (동남아, 유럽, 북아메리카 등)으로 묶여있음
  - 각 리전에는 고유한 코드 부여 ex) 서울: ap-northeast-2
  - 미국동부(버지니아 북부) 리전 > us-east-1, 뭐든지 최초
  - 리전별 가능한 서비스 다름
  - 리전 선택할 때 고려할 점
    - 지연속도 ex)북미서버면 북미리전
    - 법률 (데이터, 서비스 제광 관련) ex) 개인정보는 해당 국가 서버에 둬야한다 등
    - 사용가능한 AWS 서비스: 각 리전별로 런칭 다름
  - us-east-1 리전
    - 모든 AWS의 서비스가 최초로 서비스되는 리전
    - 기타 글로벌 서비스의 서비스 리전 ex) 빌링, 클라우드 프론트 (CDN)
* 가용영역 (Availability Zone)
  - 리전의 하부 단위
    - 하나의 리전은 2개 이상의 가용영역으로 구성
    - AZ라고 부름
    - 1개 이상의 물리 데이터 센터를 묶은 논리적 데이터 센터
  - 가용영역 구성
    - 하나 이상의 데이터 센터로 구성
    - AZ간의 연결은 매우 빠른 전용 네트워크로 구성
    - 단, 모든  AZ는 서로 100km 이내의 거리에 위치
    - 여러 재해에 대한 대비 및 보안
  - 가용영역 위치
    - 각 계정별로 AZ 코드와 실제 위치 다름
      - 계정 dev1의 AZ-A와 계정 dev2의 AZ-A와 다른 위치(랜덤)
      - 보안 이슈, 한 AZ로 몰림 현상 방지
  - AWS 구조

## 엣지로케이션 (Edge location)
* AWS의 CloudFront(CDN) 등의 여러 서비스들을 가장 빠른 속도로 제공(캐싱)하기 위한 거점
* Global Accelerator와 유저를 연결하는 거점
  - 출장소 같은 개념보안 이슈, 한 AZ로 몰림 현상 방지
* 전 세계 여러장소에 흩어져 있음
* CDN (Contents Delivery Network): 컨텐츠를 보다 빠르게 전송하는 기술
  - ex) 미국에 있는 넷플릭스 한국에서 볼 때, 아프리카에 있는 트위치 한국에서 볼 때
* 엣지로케이션 없으면 : 느림, 스트리밍 불가

## 글로벌 서비스와 리전 서비스
* 서비스 종류
  - AWS에는 서비스 제공되는 지역의 기반에 따라 글로벌 서비스와 리전 서비스로 분류
* 글로벌 서비스
  - 데이터 및 서비스를 전 세계 모든 인프라가 공유
  - ex) IAM, Route53, WAF, Billing
* 지역 서비스
  - 특정 리전을 기반으로 데이터 및 서비스 제공
  - 대부분 지역 서비스

* ARN (Amazon Resource Names)
  - AWS의 리소스에 부여되는 고유 아이디
  - ex) arn:aws:ec2:us-east-1:123456789012:vpc...
* AWS 서비스 구조
  - VPC는 원칙적으로 퍼블릭인터넷으로 접근 불가
  - AWS 내부에 있는 서비스라도 원칙적으로 퍼블릭 인터넷 통해서 접근
  - 인터넷게이트웨이 통해 외부와 접근

* VPC (Virtual Private Cloud)
  - 외부와 격리된 네트워크 만들기 위해 탄생
  - AWS 계정 전용 가상 네트워크
  - 가상으로 존재하는 데이터 센터
  - 원하는 대로 사설망 구축 가능
  - 리전 단위
  - 구조 : AWS Cloud > Amazon VPC
 
* VPC 구성요소
  - subnet: VPC를 특정 범위로 나눈 범위
  - RouteTable: 네트워크 트래픽을 전달할 위치가 명시된 규칙 집합 테이블
  - Internet GW: VPC 리소스에서의 인터넷 통신을 활성화 하기 위한 게이트웨이
  - Nat GW: 네트워크 주소 변환을 통해 private subnet 에서 인터넷 통신을 연결하는 게이트웨이
  - VPC endpoint: Nat, IGW 등을 통하지 않고 AWS의 서비스를 비공개로 연결 가능하게 하는 서비스
 
## IAM (Identity and Access Management)
* AWS 리소스에 대한 접근을 안전하게 제어하는 서비스
* 누가(AWS 사용자)가 어떤 AWS 서비스에 어떤 권한으로 접근할 수 있는지를 관리하는 역할
* IAM 요소
  - 사용자(User) → AWS 리소스에 접근하는 개별 계정
  - 그룹(Group) → 여러 사용자에게 동일한 권한을 부여할 수 있는 그룹
  - 역할(Role) → 특정 권한을 임시적으로 부여하는 역할 (AWS 서비스 간 권한 위임 가능)
  - 정책(Policy) → JSON 형식으로 작성된 접근 권한 규칙
  - MFA(Multi-Factor Authentication) → 다중 인증으로 보안 강화
* 주요 기능
  - AWS 리소스 접근 제어
    - IAM을 사용하여 AWS 서비스와 리소스에 대한 접근을 세밀하게 관리할 수 있음
    - 특정 사용자나 그룹에게 EC2, S3, RDS 등 개별 서비스에 대한 권한을 부여 가능
  - 정책(Policy) 기반 접근 관리
    - JSON 형식의 Policy 문서를 사용하여 세부적인 접근 권한 설정
  - IAM 역할(Role) 및 서비스 연동
    - EC2, Lambda, RDS 등의 AWS 서비스에 특정 권한을 부여 가능
    - ex) EC2 인스턴스가 S3 버킷 데이터 읽을 수 있도록 IAM 역할 부여 가능
  - MFA(다중 인증) 적용 가능
    - IAM 사용자 로그인 시 OTP 등 추가 인증 단계(MFA)를 설정하여 보안 강화
  - AWS 루트 계정 보호
    - AWS 계정을 생성하면 root user가 생성됨, 모든 권한을 가짐
    - 보안 강화를 위해 루트 계정 대신 IAM 사용자를 생성하여 사용하고, 루트 계정의  MFA 활성화 권장
* 주의할 점
  - 루트 계정(root user)은 최소한으로 사용
  - 최소 권한 원칙(Least Privilige Principle) 준수 → 꼭 필요한 권한만 부여
  - IAM 액세스 키(access key) 노출 금지 → GitHub 등 코드 저장소에 올리지 않기
  - IAM 정책을 잘못 설정하면 보안 사고 발생 가능 → 사용자별 최소 권한 유지
  

# S3
- AWS에서 EC2 서비스와 더불어 가장 오래되고 기본이 되는 객체 스토리지 서비스
- Amazon S3 는 확장성, 내구성, 보안성 뛰어남
- 99.9% (11 9's) 내구성 제공, 데이터 손실 최소화
- 데이터 저장 공간 거의 무제한
- 전 세계 수백만 기업의 데이터 저장하는 핵심 서비스

## S3 특징
* 객체 스토리지 서비스 : 파일 저장 전용 (EBS/EFS 등 블록 스토리지와 구분) > 어플리케이션 설치 불가
* 글로벌 서비스 단위 : 데이터는 특정 리전에 저장
* 무제한 용량 지원 : 단일 객체는 0byte ~ 5TB 저장 가능
* 최소 3개 이상 물리적으로 분리된 가용 영역에 데이터 복제
* 높은 내구성, 고가용성 제공
* OS 도움 없이 객체별 접근 가능, 데이터 저장 및 활용 용이

## 버킷과 객체
* 버킷
  - S3에서 저장공간을 구분하는 단위 (디렉토리 개념)
  - 전 세계 고유 이름 가져야 함 > 리전과 무관하게 중복 불가
  - 한번 생성 시, 이름 변경 불가
* 객체: S3에 저장되는 기본 매체
  - Owner: 소유자 정보
  - Key: 객체 이름(경로 역할)
  - Value: 파일 데이터 자체
  - Version ID: 파일 버전 식별자(버전 관리 활성화 시에만 생성)
  - Metadata: 파일 관련 정보(기본 메타데이터 외에 사용자 정의도 가능)
 
## S3 내구성 & 가용성
* 내구성 : 파일을 잃어버리지 않을 능력(극히 낮음)
* 가용성 : 내가 원할 때 쓸 수 있는 능력(*SLA 99.9%)
* 최소 3개 AZ에 중복 저장(Standard 기준)
* SLA : Service Level Agreement(서비스 수준 협약)
  - 이 서비스를 얼마나 안정적으로 사용할 수 있는가
  - 99.95% - 1년 중 약 52분 이하 다운타임/1년 중 약 1일 18시간 이하 다운
